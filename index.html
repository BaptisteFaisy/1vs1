<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Combat: Lanceur de Boules de Feu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: white;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            text-align: center;
        }
        
        header {
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #ff6600, 0 0 20px #ff3300;
            letter-spacing: 1.5px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #ffcc00;
        }
        
        .game-area {
            position: relative;
            margin: 0 auto 25px;
            width: 1700px;
            height: 750px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(255, 100, 0, 0.7);
            background: linear-gradient(to bottom, #2c3e50, #1c2833);
            border: 3px solid #ff9900;
        }
        
        canvas {
            display: block;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .player-controls {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 15px;
            flex: 1;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 200, 0, 0.3);
        }
        
        .player-controls h2 {
            color: #ffcc00;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .controls-list {
            text-align: left;
            padding: 0 20px;
        }
        
        .controls-list li {
            margin: 10px 0;
            font-size: 1.1rem;
            color: #f0f0f0;
        }
        
        .player1 .controls-list li span {
            color: #00ccff;
            font-weight: bold;
        }
        
        .player2 .controls-list li span {
            color: #ff6666;
            font-weight: bold;
        }
        
        .health-bars {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .health-bar {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 15px;
            width: 48%;
            min-width: 270px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 200, 0, 0.3);
        }
        
        .health-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .health-label {
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .player1 .health-label {
            color: #00ccff;
        }
        
        .player2 .health-label {
            color: #ff6666;
        }
        
        .health-value {
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .bar-container {
            height: 20px;
            background: #333;
            border-radius: 15px;
            overflow: hidden;
            width: 100%;
            border: 2px solid #444;
        }
        
        .bar {
            height: 100%;
            transition: width 0.3s ease;
            max-width: 100%;
        }
        
        .player1 .bar {
            background: linear-gradient(to right, #00aaff, #0066ff);
        }
        
        .player2 .bar {
            background: linear-gradient(to right, #ff5555, #ff0000);
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(0, 200, 255, 0.3);
        }
        
        .instructions h2 {
            color: #00cc99;
            margin-bottom: 15px;
            font-size: 1.6rem;
        }
        
        .instructions p {
            margin: 10px 0;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .highlight {
            color: #ffcc00;
            font-weight: bold;
        }
        
        .fire-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: -1;
            opacity: 0.2;
        }
        
        .fire-particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(#ff6600, #ff3300);
            border-radius: 50%;
            box-shadow: 0 0 15px #ff3300;
            animation: float 3s infinite ease-in;
        }
        .control-text {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-radius: 15px;
            min-width: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 200, 0, 0.3);
            text-align: center;
            font-size: 1rem;
            font-weight: bold;
        }

        .player1-controls span {
            color: #00ccff;
        }

        .player2-controls span {
            color: #ff6666;
        }
        
        @keyframes float {
            0% { transform: translateY(0) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-100px) translateX(20px); opacity: 0; }
        }
        
        @media (max-width: 850px) {
            .game-area {
                width: 95%;
                height: 400px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="fire-effect" id="fireEffect"></div>
        <div class="health-bars">
            <div class="control-text player1-controls">
                <p><span>Z Q S D</span> + <span>C</span> pour tirer</p>
            </div>
            <div class="health-bar player1">
                <div class="health-info">
                    <div class="health-label">Joueur 1 (Bleu)</div>
                    <div class="health-value" id="health1">100%</div>
                </div>
                <div class="bar-container">
                    <div class="bar" id="bar1" style="width: 100%"></div>
                </div>
            </div>
            
            <div class="health-bar player2">
                <div class="health-info">
                    <div class="health-label">Joueur 2 (Rouge)</div>
                    <div class="health-value" id="health2">100%</div>
                </div>
                <div class="bar-container">
                    <div class="bar" id="bar2" style="width: 100%"></div>
                </div>
            </div>
            <div class="control-text player2-controls">
                <p><span>↑ ↓ ← →</span> + <span>0</span> pour tirer</p>
            </div>
        </div>
        
        <div class="game-area">
            <canvas id="gameCanvas" width="1700" height="750"></canvas>
        </div>


    <script>
        // Création des particules de feu en arrière-plan
        function createFireParticles() {
            const container = document.getElementById('fireEffect');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('fire-particle');
                
                // Position aléatoire
                const left = Math.random() * 100;
                const bottom = Math.random() * 20;
                particle.style.left = `${left}%`;
                particle.style.bottom = `${bottom}%`;
                
                // Animation aléatoire
                const duration = 2 + Math.random() * 3;
                const delay = Math.random() * 5;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${delay}s`;
                
                container.appendChild(particle);
            }
        }
        
        // Configuration du jeu
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Dimensions du jeu
        const gameWidth = canvas.width;
        const gameHeight = canvas.height;
        
        // Personnages
        const player1 = {
            x: 150,
            y: gameHeight - 400,
            width: 75,
            height: 75,
            speed: 10,
            health: 100,
            color: '#00ccff',
            lastFire: 0,
            lastDirection: { dx: 0, dy: 0 } // Stocke la dernière direction
        };
        
        const player2 = {
            x: gameWidth - 200,
            y: gameHeight - 400,
            width: 75,
            height: 75,
            speed: 10,
            health: 100,
            color: '#ff6666',
            lastFire: 0,
            lastDirection: { dx: 0, dy: 0 } // Stocke la dernière direction
        };
        
        // Boules de feu
        const fireballs = [];
        const fireballRadius = 15;
        const fireballSpeed = 30;
        
        // État des touches
        const keys = {
            ArrowUp: false,
            ArrowDown: false,
            ArrowLeft: false,
            ArrowRight: false,
            KeyW: false,
            KeyS: false,
            KeyA: false,
            KeyD: false,
            KeyC: false,
            Numpad0: false
        };
        
        // Gestionnaires d'événements
        window.addEventListener('keydown', (e) => {
            if (keys.hasOwnProperty(e.code)) {
                keys[e.code] = true;
            }
        });
        
        window.addEventListener('keyup', (e) => {
            if (keys.hasOwnProperty(e.code)) {
                keys[e.code] = false;
            }
        });
        function checkPlayerCollision() {
            const dx = player1.x - player2.x;
            const dy = player1.y - player2.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const minDistance = (player1.width + player2.width) / 2;
            
            if (distance < minDistance) {
                // Calculer l'angle de collision
                const angle = Math.atan2(dy, dx);
                const force = 10; // Force de repoussement
                
                // Repousser les joueurs
                const moveX = Math.cos(angle) * force;
                const moveY = Math.sin(angle) * force;
                
                player1.x += moveX;
                player1.y += moveY;
                player2.x -= moveX;
                player2.y -= moveY;
                
                // Garder les joueurs dans les limites du canvas
                player1.x = Math.max(0, Math.min(gameWidth - player1.width, player1.x));
                player1.y = Math.max(0, Math.min(gameHeight - player1.height, player1.y));
                player2.x = Math.max(0, Math.min(gameWidth - player2.width, player2.x));
                player2.y = Math.max(0, Math.min(gameHeight - player2.height, player2.y));
            }
        }
        
        // Mettre à jour les positions
        function update() {
            // Déplacement du joueur 1 (ZQSD)
            if (keys.KeyW && player1.y > 0) {
                player1.y -= player1.speed;
                player1.lastDirection = { dx: 0, dy: -1 }; // Haut
            }
            if (keys.KeyS && player1.y < gameHeight - player1.height) {
                player1.y += player1.speed;
                player1.lastDirection = { dx: 0, dy: 1 }; // Bas
            }
            if (keys.KeyA && player1.x > 0) {
                player1.x -= player1.speed;
                player1.lastDirection = { dx: -1, dy: 0 }; // Gauche
            }
            if (keys.KeyD && player1.x < gameWidth - player1.width) {
                player1.x += player1.speed;
                player1.lastDirection = { dx: 1, dy: 0 }; // Droite
            }
            
            // Déplacement du joueur 2 (Flèches)
            if (keys.ArrowUp && player2.y > 0) {
                player2.y -= player2.speed;
                player2.lastDirection = { dx: 0, dy: -1 }; // Haut
            }
            if (keys.ArrowDown && player2.y < gameHeight - player2.height) {
                player2.y += player2.speed;
                player2.lastDirection = { dx: 0, dy: 1 }; // Bas
            }
            if (keys.ArrowLeft && player2.x > 0) {
                player2.x -= player2.speed;
                player2.lastDirection = { dx: -1, dy: 0 }; // Gauche
            }
            if (keys.ArrowRight && player2.x < gameWidth - player2.width) {
                player2.x += player2.speed;
                player2.lastDirection = { dx: 1, dy: 0 }; // Droite
            }

            checkPlayerCollision();
            
            // Gestion des tirs
            const currentTime = Date.now();
            
            // Joueur 1 (touche F)
            if (keys.KeyC && currentTime - player1.lastFire > 500) {
                createFireball(player1);
                player1.lastFire = currentTime;
            }
            
            // Joueur 2 (touche M)
            if (keys.Numpad0 && currentTime - player2.lastFire > 500) {
                createFireball(player2);
                player2.lastFire = currentTime;
            }
            
            // Mettre à jour les boules de feu
            for (let i = fireballs.length - 1; i >= 0; i--) {
                const fb = fireballs[i];
                fb.x += fb.dx;
                fb.y += fb.dy;
                
                // Vérifier les collisions avec les bords
                if (fb.x < 0 || fb.x > gameWidth || fb.y < 0 || fb.y > gameHeight) {
                    fireballs.splice(i, 1);
                    continue;
                }
                
                // Vérifier les collisions avec les joueurs
                const targetPlayer = fb.player === player1 ? player2 : player1;
                if (isColliding(fb, targetPlayer)) {
                    targetPlayer.health -= 20;
                    fireballs.splice(i, 1);
                    resetGame(1);
                    
                }
            }
        }
        
        // Créer une boule de feu
        function createFireball(player) {
            // Vérifier si une direction est définie
            if (player.lastDirection.dx === 0 && player.lastDirection.dy === 0) {
                // Si aucune direction n'est définie, utiliser une direction par défaut
                player.lastDirection = { dx: player === player1 ? 1 : -1, dy: 0 };
            }
            
            fireballs.push({
                x: player.x + player.width/2,
                y: player.y + player.height/2,
                radius: fireballRadius,
                dx: player.lastDirection.dx * fireballSpeed,
                dy: player.lastDirection.dy * fireballSpeed,
                color: player === player1 ? '#00ccff' : '#ff6666',
                player: player
            });
        }
        
        // Vérifier les collisions
        function isColliding(fireball, player) {
            return fireball.x > player.x && 
                   fireball.x < player.x + player.width &&
                   fireball.y > player.y && 
                   fireball.y < player.y + player.height;
        }
        
        // Mettre à jour les barres de vie
        function updateHealthBars() {
            document.getElementById('health1').textContent = `${player1.health}%`;
            document.getElementById('bar1').style.width = `${player1.health}%`;
            document.getElementById('health2').textContent = `${player2.health}%`;
            document.getElementById('bar2').style.width = `${player2.health}%`;
            
            // Vérifier si un joueur a gagné
            if (player1.health <= 0 || player2.health <= 0) {
                const winner = player1.health > player2.health ? "Joueur 1 (Bleu)" : "Joueur 2 (Rouge)";
                setTimeout(() => {
                    alert(`${winner} a gagné !`);
                    resetGame(0);
                }, 100);
            }
        }
        
        // Réinitialiser le jeu
        function resetGame(nbr) {
            player1.x = 150;
            player1.y = gameHeight - 400;
            if (nbr == 0)
                player1.health = 100;
            player1.lastDirection = { dx: 0, dy: 0 };
            
            player2.x = gameWidth - 200;
            player2.y = gameHeight - 400;
            if (nbr == 0)
                player2.health = 100;
            player2.lastDirection = { dx: 0, dy: 0 };
            fireballs.length = 0;
            updateHealthBars();
            for (let key in keys) {
                keys[key] = false;
            }
        }
        
        // Dessiner les éléments
        function render() {
            // Effacer l'écran
            ctx.clearRect(0, 0, gameWidth, gameHeight);
            
            // Dessiner le sol
            ctx.fillStyle = '#333';
            ctx.fillRect(0, gameHeight - 20, gameWidth, 20);
            
            // Dessiner le joueur 1
            ctx.fillStyle = player1.color;
            ctx.fillRect(player1.x, player1.y, player1.width, player1.height);
            
            // Dessiner le joueur 2
            ctx.fillStyle = player2.color;
            ctx.fillRect(player2.x, player2.y, player2.width, player2.height);
            
            // Dessiner les boules de feu
            fireballs.forEach(fb => {
                ctx.beginPath();
                ctx.arc(fb.x, fb.y, fb.radius, 0, Math.PI * 2);
                ctx.fillStyle = fb.color;
                ctx.fill();
            });
            
            // Dessiner la direction actuelle des joueurs (pour le debug)
            drawDirectionIndicator(player1);
            drawDirectionIndicator(player2);
        }
        
        // Dessiner un indicateur de direction
        function drawDirectionIndicator(player) {
            const indicatorLength = 50;
            const centerX = player.x + player.width/2;
            const centerY = player.y + player.height/2;
            
            if (player.lastDirection.dx !== 0 || player.lastDirection.dy !== 0) {
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(
                    centerX + player.lastDirection.dx * indicatorLength,
                    centerY + player.lastDirection.dy * indicatorLength
                );
                ctx.strokeStyle = player === player1 ? '#00ccff' : '#ff6666';
                ctx.lineWidth = 3;
                ctx.stroke();
                
                // Dessiner une flèche
                const arrowSize = 15;
                const endX = centerX + player.lastDirection.dx * indicatorLength;
                const endY = centerY + player.lastDirection.dy * indicatorLength;
                
                ctx.beginPath();
                ctx.moveTo(endX, endY);
                
                if (player.lastDirection.dx !== 0) {
                    ctx.lineTo(endX - player.lastDirection.dx * arrowSize, endY - arrowSize);
                    ctx.lineTo(endX - player.lastDirection.dx * arrowSize, endY + arrowSize);
                } else {
                    ctx.lineTo(endX - arrowSize, endY - player.lastDirection.dy * arrowSize);
                    ctx.lineTo(endX + arrowSize, endY - player.lastDirection.dy * arrowSize);
                }
                
                ctx.closePath();
                ctx.fillStyle = player === player1 ? '#00ccff' : '#ff6666';
                ctx.fill();
            }
        }
        
        // Boucle de jeu
        function gameLoop() {
            
            update();
            render();
            requestAnimationFrame(gameLoop);
        }
        
        // Initialisation
        createFireParticles();
        updateHealthBars();
        gameLoop();
    </script>
</body>
</html>